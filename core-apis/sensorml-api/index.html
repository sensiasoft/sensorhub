<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>SensorML API - OpenSensorHub</title>
  

  <link rel="shortcut icon" href="../../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "SensorML API";
    var mkdocs_page_input_path = "core-apis/sensorml-api.md";
    var mkdocs_page_url = "/core-apis/sensorml-api/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script> 

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-36723568-3', 'opensensorhub.org');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <img src="/img/logo-light.png"/>
        <a href="../.." class="icon"> OpenSensorHub</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Introduction</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Getting Started</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../download/">Download</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../install/">Installation</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>User Documentation</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../user-guide/">Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../swe-services/">SWE Services</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Developer Documentation</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../dev-guide/">Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../architecture/">Architecture</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../apidocs/">Javadoc</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Tutorials</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tutos/adding-new-modules/">Adding New Modules</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../tutos/your-first-sensor/">Your First Sensor</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Core APIs</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../">Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">SensorML API</a>
        
            <ul>
            
                <!--<li class="toctree-l3"><a href="#swe-common-sensorml-api">SWE Common / SensorML API</a></li>-->
                
                    <li><a class="toctree-l4" href="#high-level-descriptive-info">High-Level Descriptive Info</a></li>
                
                    <li><a class="toctree-l4" href="#advanced-metadata">Advanced Metadata</a></li>
                
                    <li><a class="toctree-l4" href="#location">Location</a></li>
                
                    <li><a class="toctree-l4" href="#inputsoutputsparameters">Inputs/Outputs/Parameters</a></li>
                
                    <li><a class="toctree-l4" href="#reference-frames">Reference Frames</a></li>
                
                    <li><a class="toctree-l4" href="#write-out-as-xml">Write-out as XML</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sensor-api/">Sensor API</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sensornet-api/">Sensor Net API</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../license/">License</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OpenSensorHub</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Core APIs &raquo;</li>
        
      
    
    <li>SensorML API</li>
    <li class="wy-breadcrumbs-aside">
      <!--
        
          <a href="https://github.com/opensensorhub/" class="icon icon-github"> Edit on GitHub</a>
        
      -->
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h2 id="swe-common-sensorml-api">SWE Common / SensorML API</h2>
<p>In SensorHub, sensor descriptions (or sensor metadata) are in the <a href="http://www.opengeospatial.org/standards/sensorml">SensorML 2.0</a> format, an international open standard from the <a href="http://www.opengeospatial.org">Open Geospatial Consortium (OGC)</a>. They are often generated (at least partly) from code using the java SensorML bindings included in <a href="https://github.com/sensiasoft/lib-sensorml">lib-sensorml</a>.</p>
<p>These bindings are automatically generated from the 2.0 XML schemas and thus are a direct reflection of the types and properties that are defined by it. The general rule is that each <a href="http://www.w3.org/TR/xmlschema-1/#Complex_Type_Definitions">XML Schema Complex Type</a> (except OGC Property Types) becomes a Java interface with appropriate methods to handle each property (get/set/isSet/unSet, getNum/add for multiplicity &gt; 1, etc.).</p>
<p>There is one subtle difference compared to other bindings that could be generated with commonly used tools such as JAXB or XML Beans: OGC Property Types are not generated as separate objects thus removing many unnecessary layers in the generated object tree. Instead, properties are handled as a generic <a href="https://github.com/sensiasoft/lib-swe-common/blob/master/swe-common-core/src/main/java/net/opengis/OgcProperty.java"><em>OgcProperty</em></a> object, containing all info carried by the property such as name, xlink attributes, etc., and accessible via <em>'getProperty'</em> methods. This means that calls to regular get methods would return the property value directly which makes constructing the object much more straight forward. This design allows for handling the entire content model from many OGC schemas without making the resulting object tree too complex.</p>
<p>Let's look at examples of how to set different parts of a SensorML document using this API (All code in the following section assumes you have an instance of <em>PhysicalComponent</em> or <em>PhysicalSystem</em> called <em>'system'</em> on hand).</p>
<p><em>Note: Most of the following examples are actually extracted from the 'testGenerateInstance()' method of this <a href="https://github.com/sensiasoft/lib-sensorml/blob/master/sensorml-core/src/test/java/org/vast/sensorML/test/TestSMLBindingsV20.java">JUnit Test Class</a> so you can look at the code directly</em></p>
<h3 id="high-level-descriptive-info">High-Level Descriptive Info</h3>
<p>The first thing you need to do to create or add to a SensorML description is to instantiate SML and SWE helperfactories:</p>
<pre><code class="java">SMLHelper smlFac = new SMLHelper();
SWEHelper sweFac = new SWEHelper();
</code></pre>

<p>Then, if you don't already have one, create the top level process or system instance. For instance a <code>PhysicalSystem</code> entity is created like so:</p>
<pre><code class="java">PhysicalSystem system = smlFac.newPhysicalSystem();
</code></pre>

<p>You can then set name and description of the system:</p>
<pre><code class="java">system.setName(&quot;Garage Thermometer&quot;);
system.setDescription(&quot;Thermometer located next to the door inside my garage&quot;);
</code></pre>

<p>You can also set the parent type of this sensor (this is typically used to reference a SensorML description providing more details about the sensor such as the SensorML document/datasheet provided by the manufacturer):</p>
<pre><code class="java">system.setTypeOf(new ReferenceImpl(&quot;http://manufacturer.org/datasheets/sensor1234.xml&quot;));
</code></pre>

<h3 id="advanced-metadata">Advanced Metadata</h3>
<p>Add contact information:</p>
<pre><code class="java">ContactList contacts = smlFac.newContactList();
CIResponsibleParty contact = smlFac.newResponsibleParty();
contact.setIndividualName(&quot;Gérard Blanquet&quot;);
contact.setOrganisationName(&quot;Time Soft S.A.&quot;);
contact.getContactInfo().getAddress().addDeliveryPoint(&quot;10 rue du Nord&quot;);
contact.getContactInfo().getAddress().setPostalCode(&quot;75896&quot;);
contact.getContactInfo().getAddress().setCity(&quot;Paris&quot;);
contact.getContactInfo().getAddress().setCountry(&quot;FRANCE&quot;);
contact.setRole(new CodeListValueImpl(&quot;operator&quot;));
contacts.addContact(contact);
system.addContacts(contacts);
</code></pre>

<p>Add characteristics:</p>
<pre><code class="java">CharacteristicList mechSpecs = smlFac.newCharacteristicList();
Quantity weightSpec = sweFac.newQuantity(&quot;http://sweet.jpl.nasa.gov/2.3/propMass.owl#Mass&quot;, &quot;Weight&quot;, null, &quot;kg&quot;);
weightSpec.setValue(12.3);
mechSpecs.addCharacteristic(&quot;weight&quot;, weightSpec);
system.addCharacteristics(&quot;mechanical&quot;, mechSpecs);
</code></pre>

<h3 id="location">Location</h3>
<p>Add location as GML point:</p>
<pre><code class="java">GMLFactory gmlFac = new GMLFactory();
Point pos = gmlFac.newPoint();
pos.setId(&quot;P01&quot;);
pos.setSrsName(&quot;http://www.opengis.net/def/crs/EPSG/0/4979&quot;);
pos.setPos(new double[] {45.6, 2.3, 193.2});
system.addPositionAsPoint(pos);
</code></pre>

<h3 id="inputsoutputsparameters">Inputs/Outputs/Parameters</h3>
<p>All inputs, outputs and parameters in SensorML are described using the SWE Common Language so you can use the <code>SWEHelper</code> class to create these structures. </p>
<p>Add observable property as input:</p>
<pre><code class="java">ObservableProperty obs = new ObservablePropertyImpl();
obs.setDefinition(&quot;http://mmisw.org/ont/cf/parameter/weather&quot;);
system.addInput(&quot;weather_phenomena&quot;, obs);
</code></pre>

<p>You can also add an input as xlink reference:</p>
<pre><code class="java">system.getInputList().add(&quot;rain&quot;, &quot;http://remotedef.xml&quot;, null);
</code></pre>

<p>Add output record (in this case we first create the record object and then add sub-components to it, before we add it as output):</p>
<pre><code class="java">// create output record and set description
DataRecord rec = sweFac.newDataRecord();
rec.setLabel(&quot;Weather Data Record&quot;);
rec.setDescription(&quot;Record of synchronous weather measurements&quot;);

// sampling time
rec.addField(&quot;time&quot;, sweFac.newTimeStampIsoUTC());

// temperature measurement
rec.addField(&quot;temp&quot;, sweFac.newQuantity(
                            &quot;http://mmisw.org/ont/cf/parameter/air_temperature&quot;, 
                            &quot;Air Temperature&quot;, null, &quot;Cel&quot;));

// pressure
rec.addField(&quot;press&quot;, sweFac.newQuantity(
                            &quot;http://mmisw.org/ont/cf/parameter/air_pressure_at_sea_level&quot;,
                            &quot;Air Pressure&quot;, null, &quot;mbar&quot;));

// wind speed
rec.addField(&quot;wind_speed&quot;, sweFac.newQuantity(
                            &quot;http://mmisw.org/ont/cf/parameter/wind_speed&quot;,
                            &quot;Wind Speed&quot;, null, &quot;km/h&quot;));

// wind direction
rec.addField(&quot;wind_dir&quot;, sweFac.newQuantity(
                            &quot;http://mmisw.org/ont/cf/parameter/wind_to_direction&quot;,
                            &quot;Wind Direction&quot;, null, &quot;deg&quot;));

// add as output
system.addOutput(&quot;weather_data&quot;, rec);
</code></pre>

<p>You can also add accuracy info to some of the measured outputs:</p>
<pre><code class="java">// add accuracy info to temp output
Quantity acc = sweFac.newQuantity(
                      &quot;http://mmisw.org/ont/cf/parameter/accuracy&quot;,
                      &quot;Accuracy&quot;, null, &quot;%&quot;);
(Quantity)rec.getField(&quot;temp&quot;)).addQuality(acc);
</code></pre>

<p>Parameters can be added in a similar fashion:</p>
<pre><code class="java">system.addParameter(&quot;samplingPeriod&quot;, sweFac.newQuantity(
                       &quot;http://sensorml.com/ont/swe/property/SamplingPeriod&quot;,
                       &quot;Sampling Period&quot;, null, &quot;s&quot;));
</code></pre>

<h3 id="reference-frames">Reference Frames</h3>
<p>One important information that can be added to a sensor or system description is documentation about the reference frame that is attached to it. This is useful for properly processing positioning information in advanced geolocation workflows. Below is an example spatial reference frame definition:</p>
<pre><code class="java">SpatialFrame systemFrame = smlFac.newSpatialFrame();
systemFrame.setId(&quot;SYSTEM_FRAME&quot;);
systemFrame.setLabel(&quot;System Reference Frame&quot;);
systemFrame.setDescription(&quot;Cartesian reference frame attached to system assembly&quot;);
systemFrame.setOrigin(&quot;Origin is located on the red marking at the bottom of the aluminum chassis&quot;);
systemFrame.addAxis(&quot;x&quot;, &quot;X axis is aligned with the horizontal edge of the chassis (see marking)&quot;);
systemFrame.addAxis(&quot;y&quot;, &quot;Y axis is orthogonal to both X and Y in order to form a direct orthogonal frame&quot;);
systemFrame.addAxis(&quot;z&quot;, &quot;Z axis is pointing toward the top of the assembly, aligned with the vertical edge of the aluminum frame&quot;);
system.addLocalReferenceFrame(systemFrame);
</code></pre>

<h3 id="write-out-as-xml">Write-out as XML</h3>
<p>Once you have the java object tree created, it is trivial to serialize it as XML that is compliant to the SensorML standard:</p>
<pre><code class="java">new SMLUtils().writeProcess(System.out, system, true);
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../sensor-api/" class="btn btn-neutral float-right" title="Sensor API"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../" class="btn btn-neutral" title="Introduction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>© Copyright 2015 Sensia Software LLC</p>
    
  </div>

</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/opensensorhub/" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../sensor-api/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
